<!DOCTYPE html>
<html>
<head>
  <title><%= @page ? @page.title : 'Page inconnue' %></title>
  <meta charset="UTF-8">
  <meta name="description" content="<%= @page.description if @page %>">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <% if @site %>
    <%= stylesheet_link_tag (conf[:custom_styles] ? @site.style_url : @site.site_template.path), media: "all" %>
    <%= javascript_include_tag @site.site_template.path %>
    <% unless @site.analytics_id.blank? %>
      <script async src="https://www.googletagmanager.com/gtag/js?id=<%= @site.analytics_id %>"></script>
      <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', '<%= @site.analytics_id %>');
      </script>
    <% end %>
  <% end %>
  <%= csrf_meta_tags %>
  <% if @site && !@site.header_code.blank? %>
    <%= raw @site.header_code %>
  <% end %>
  <% if @page && !@page.header_code.blank? %>
    <%= raw @page.header_code %>
  <% end %>
  <%= yield :included_styles %>
  <%= yield :included_scripts %>
</head>
<body>

<%= yield %>

<%= yield :page_scripts %>
<%= yield :site_scripts %>
<% if @page && !@page.footer_code.blank? %>
  <%= raw @page.footer_code %>
<% end %>
<% if @site && !@site.footer_code.blank? %>
  <%= raw @site.footer_code %>
<% end %>
</body>
</html>
